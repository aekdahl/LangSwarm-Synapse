---
title: VotingChain
sidebar_position: 34
---

# VotingChain

---

## **Overview**
The `VotingChain` class is a custom, LangChain-compatible chain designed to facilitate voting-based decision-making among multiple Large Language Model (LLM) agents. It integrates the `LLMVoting` class to aggregate and evaluate responses based on a voting mechanism, ensuring that the output represents the consensus or majority decision of the participating agents.

This chain is ideal for scenarios where democratic decision-making, ranking, or selection of the most popular response is required.

---

## **Purpose**
The primary purpose of the `VotingChain` class is:
- **Voting-Based Workflows**: To collect, compare, and evaluate responses from multiple agents, selecting the most favored result based on voting.
- **Pipeline Integration**: To act as a reusable chain within LangChain workflows, enabling seamless integration with other tools or chains.
- **Transparency**: To provide detailed insights into the voting process, including the group size and all responses.

---

## **Class Definition**

```python
class VotingChain(Chain):
    def __init__(self, agents, **kwargs):
        """
        Initializes the VotingChain.

        Parameters:
        - agents (list): List of agents to use in the voting process.
        - kwargs: Additional parameters for the LLMVoting class.
        """
        self.voting = LLMVoting(clients=agents, **kwargs)

    @property
    def input_keys(self):
        """Define input keys for the chain."""
        return ["query"]

    @property
    def output_keys(self):
        """Define output keys for the chain."""
        return ["voting_result", "group_size", "responses"]

    def _call(self, inputs):
        """
        Processes the input query and returns the voting result.

        Parameters:
        - inputs (dict): Dictionary containing the query.

        Returns:
        - dict: Dictionary containing the voting result, group size, and responses.
        """
        query = inputs["query"]
        result, group_size, responses = self.voting.run()
        return {
            "voting_result": result,
            "group_size": group_size,
            "responses": responses,
        }
```

---

## **Key Components**

1. **`__init__` Method**
   - Initializes the chain with a list of agents and additional parameters.
   - Creates an instance of the `LLMVoting` class to handle the voting process.
   - Parameters:
     - `agents`: A list of LLM agents contributing to the voting process.
     - `kwargs`: Optional parameters passed to configure the `LLMVoting` class.

2. **`input_keys` Property**
   - Specifies the input keys required by the chain.
   - Inputs:
     - `query`: The user query or task to be resolved through voting.

3. **`output_keys` Property**
   - Specifies the output keys returned by the chain.
   - Outputs:
     - `voting_result`: The winning result based on the voting process.
     - `group_size`: The number of agents participating in the voting.
     - `responses`: A list of all responses generated by the agents.

4. **`_call` Method**
   - Core logic for executing the chain.
   - Workflow:
     - Accepts a `query` input.
     - Calls the `run` method of `LLMVoting` to execute the voting process.
     - Returns the voting result, group size, and all responses as a dictionary.

---

## **Usage**

1. **Initialization**
   ```python
   from langswarm.swarm.voting import LLMVoting
   from mymodule import VotingChain

   # Example list of agents (LLM clients)
   agents = [agent1, agent2, agent3]

   # Initialize the VotingChain
   chain = VotingChain(agents=agents, param1=value1, param2=value2)
   ```

2. **Execution**
   ```python
   # Input data
   inputs = {
       "query": "What is the best approach to reduce carbon emissions globally?",
   }

   # Get the voting result
   result = chain(inputs)
   print("Winning Result:", result["voting_result"])
   print("Group Size:", result["group_size"])
   print("All Responses:", result["responses"])
   ```

3. **Integration with LangChain Pipelines**
   - The `VotingChain` can be integrated into LangChain workflows as a standalone chain or in combination with other chains and tools.
   ```python
   from langchain.chains import SequentialChain

   # Example pipeline
   pipeline = SequentialChain(chains=[chain, another_chain])
   pipeline.run(inputs)
   ```

---

## **Customization**
- **Adding Custom Parameters**: Pass additional parameters to `LLMVoting` via the `kwargs` argument during initialization.
- **Extending the Chain**: Subclass `VotingChain` to modify or extend functionality, such as customizing the voting mechanism or the way results are presented.

---

## **Use Cases**
1. **Decision-Making**:
   - Use voting among multiple agents to select the best course of action, solution, or opinion.
2. **Consensus Building**:
   - Identify the most agreed-upon response in group settings.
3. **Ranking and Prioritization**:
   - Rank responses and highlight the top choice.
4. **Bias Mitigation**:
   - Evaluate diverse perspectives from multiple agents and select the most representative result.

---

## **Comparison with Other Chains**
- **VotingChain**: Uses a democratic voting mechanism to select the best or most popular response.
- **BranchingChain**: Generates multiple diverse responses without selecting a single winner.
- **AggregationChain**: Synthesizes responses into a unified result rather than selecting one.

---

This documentation provides a comprehensive explanation of the `VotingChain` class, including its purpose, structure, and usage. Let me know if youâ€™d like further clarifications or enhancements!
